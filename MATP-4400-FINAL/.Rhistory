theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel)
plot_grid(inactivity_1, smoke_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(fsmoking.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = rev("RdYlBu"), labels= vlabel)
inactivity_1<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = rev("RdYlBu"), labels= vlabel)
plot_grid(inactivity_1, smoke_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(fsmoking.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
inactivity_1<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(inactivity_1, smoke_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(fsmoking.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
inactivity_2<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(inactivity_1, inactivity_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
plot_grid(covid_1, covid_2, ncol = 1)
View(us_fsmoking)
View(fsmoking.df)
unique(fsmoking.df$dgroup)
plot_grid(covid_1, covid_2, ncol = 1)
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(fsmoking.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
inactivity_2<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.1) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(inactivity_1, inactivity_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(fsmoking.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- inactivity.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
inactivity_2<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(inactivity_1, inactivity_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(finactivity.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- inactivity.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
inactivity_2<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(inactivity_1, inactivity_2, ncol = 1)
# US_drinking value is the median value of states and DC
US_drinking<- US_behavior %>% filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
drinking.df<- behaviors_sex.df %>%
filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
drinking.df$value.disparity<- log(drinking.df$Value/US_drinking$Value)
fdrinking.df<- drinking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
fdrinking.df$region<- tolower(fdrinking.df$State.Name)
fdrinking.df$vgroup<- as.numeric(cut(fdrinking.df$value.disparity, breaks = vcut_by))
mdrinking.df<- drinking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
mdrinking.df$region<- tolower(mdrinking.df$State.Name)
mdrinking.df$vgroup<- as.numeric(cut(mdrinking.df$value.disparity, breaks = vcut_by))
us_fdrinking<- left_join(us_states, fdrinking.df)
us_mdrinking<- left_join(us_states, mdrinking.df)
drinking_1<- ggplot(data = us_fdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
drinking_2<- ggplot(data = us_mdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(drinking_1, drinking_2, ncol = 1)
# stick libraries here
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(plotly)
library(maps)
library(cowplot)
all_states.df <- read.csv("~/COVID-Notebooks/data/2019-Annual.csv")
all_states<- unique(all_states.df$State.Name) %>% sort()
# Sort data frame by states
all_states.df<- all_states.df %>%
arrange(factor(all_states.df$State.Name, levels = all_states))
# America's Health Ranking (data source) defined health outcome as the interaction betweenthe 4 asepcts: behaviors, commuinty & environment, policy, and clinical care
# Pick data for behaviors as topic of this project
behaviors<- c("Excessive Drinking","Physical Inactivity", "Smoking")
behaviors.df <- filter(all_states.df, grepl(paste(behaviors, collapse="|"), Measure.Name))
# Calculate the number of covid death by state then categorize by sex
death_count<- read.csv("~/COVID-Notebooks/data/csv/Provisional_COVID-19_Death_Counts_by_Sex__Age__and_State.csv")
pick<- c("Male Total", "Female Total")
death_count<- death_count %>%
filter(grepl(paste(pick, collapse="|"), Sex)) %>%
select(State, Sex, COVID.19.Deaths)
US_death<- death_count[death_count$State == "United States", ]
NYC_death<- death_count[death_count$State == "New York City", ]
drop <- c("United States", "New York City", "Puerto Rico")
death_count<- death_count[!(death_count$State %in% drop), ]
row.names(death_count) <- NULL
n<- which(grepl("New York", death_count$State))
death_count$COVID.19.Deaths[n[1]]<- death_count$COVID.19.Deaths[n[1]] + NYC_death$COVID.19.Deaths[1]
death_count$COVID.19.Deaths[n[2]]<- death_count$COVID.19.Deaths[n[2]] + NYC_death$COVID.19.Deaths[2]
fmean_death<- US_death$COVID.19.Deaths[2]/53
mmean_death<- US_death$COVID.19.Deaths[1]/53
US_death$mean_death<- c(fmean_death, mmean_death)
death_count$death.disparity<- log(death_count$COVID.19.Deaths/US_death$mean_death)
death_count<- death_count[c(rbind(seq(2, nrow(death_count), 2), seq(1, nrow(death_count), 2))),]
dcut_by<- c(5, 2, 1, .2, -.2, -1, -2, -5)
fdeath.df<- death_count %>% filter(grepl(paste("Female", collapse="|"), Sex))
fdeath.df$dgroup<- as.numeric(cut(fdeath.df$death.disparity, breaks = dcut_by))
mdeath.df<- death_count %>% filter(grepl(paste("Male", collapse="|"), Sex))
mdeath.df$dgroup<- as.numeric(cut(mdeath.df$death.disparity, breaks = dcut_by))
# Behaviors (excluding drug death and obesity) vs COVID death
sex<- c("Female", "Male")
# Filter out only the data that contain information with sex
behaviors_sex.df<- behaviors.df %>%
filter(grepl(paste(sex, collapse="|"), Measure.Name)) %>%
select(State.Name, Measure.Name, Value)
US_behavior<- behaviors_sex.df[behaviors_sex.df$State.Name == "United States", ]
behaviors_sex.df<- behaviors_sex.df[behaviors_sex.df$State.Name != "United States", ]
us_states <- map_data("state")
vlabel<- c("-1 to -.5", "-.5 to -.25", "-.25 to -.1", "-.1 to 0", "0 to .1", ".1 to .25", ".25 to .5", ".5 to 1")
vcut_by<- c(-1,-.5,-.25,-.1,0,.1,.25,.5,1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_inactivity value is the median value of states and DC
US_inactivity<- US_behavior %>% filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df<- behaviors_sex.df %>%
filter(grepl(paste("Physical Inactivity", collapse="|"), Measure.Name))
inactivity.df$value.disparity<- log(inactivity.df$Value/US_inactivity$Value)
finactivity.df<- inactivity.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
finactivity.df$region<- tolower(finactivity.df$State.Name)
finactivity.df$vgroup<- as.numeric(cut(finactivity.df$value.disparity, breaks = vcut_by))
minactivity.df<- inactivity.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
minactivity.df$region<- tolower(minactivity.df$State.Name)
minactivity.df$vgroup<- as.numeric(cut(minactivity.df$value.disparity, breaks = vcut_by))
us_finactivity<- left_join(us_states, finactivity.df)
us_minactivity<- left_join(us_states, minactivity.df)
inactivity_1<- ggplot(data = us_finactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
inactivity_2<- ggplot(data = us_minactivity, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Physical Inactivity Disparity")+labs(fill = "Physical Inactivity Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(inactivity_1, inactivity_2, ncol = 1)
# US_drinking value is the median value of states and DC
US_drinking<- US_behavior %>% filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
drinking.df<- behaviors_sex.df %>%
filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
drinking.df$value.disparity<- log(drinking.df$Value/US_drinking$Value)
fdrinking.df<- drinking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
fdrinking.df$region<- tolower(fdrinking.df$State.Name)
fdrinking.df$vgroup<- as.numeric(cut(fdrinking.df$value.disparity, breaks = vcut_by))
mdrinking.df<- drinking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
mdrinking.df$region<- tolower(mdrinking.df$State.Name)
mdrinking.df$vgroup<- as.numeric(cut(mdrinking.df$value.disparity, breaks = vcut_by))
us_fdrinking<- left_join(us_states, fdrinking.df)
us_mdrinking<- left_join(us_states, mdrinking.df)
drinking_1<- ggplot(data = us_fdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
drinking_2<- ggplot(data = us_mdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(drinking_1, drinking_2, ncol = 1)
