msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ region, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + geom_text(data = cnames, aes(group = group, long, lat, label = region), size = 5) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ region, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
install.packages("ggrepel")
library(ggrepel)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ region, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + geom_text_repel(data = cnames, aes(x = long, y = lat, label = region),
fontface = "bold", nudge_x = c(1, -1.5, 2, 2, -1), nudge_y = c(0.25, -0.25, 0.5, 0.5, -0.5)) +coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ region, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1) +
geom_text_repel(data = cnames, aes(x = long, y = lat, label = region), fontface = "bold", nudge_x = c(1, -1.5, 2, 2, -1), nudge_y = c(0.25, -0.25, 0.5, 0.5, -0.5))
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ region, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = region, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ State.Name, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = region, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ State.Name, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = State.Name, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
View(all_states.df)
us_states$subregion<- state.abb[grep(all_states, us_states$region)]
us_states$abb<- state.abb[grep(all_states, us_states$region)]
View(us_states)
us_states$subregion<- state.abb[grep(all_states, us_states$region),]
us_states$subregion<- state.abb[grep(all_states, us_states$region)]
state.abb[grep(all_states, us_states$region)]
state.abb[match(all_states, us_states$region)]
class(all_states)
us_states$subregion<- state.abb[which(us_states$region == as.vector(all_states))]
us_states$subregion<- state.abb[which(us_states$region == tolower(all_states))]
abb<- state.abb[which(us_states$region == tolower(all_states))]
abb<- state.abb[which(us_states$region == tolower(all_states))] %>% na.omit()
abb<- state.abb[grep(us_states$region == tolower(all_states))] %>% na.omit()
state.abb[match(us_states$region,tolower(all_states))]
us_states$subregion<- state.abb[match(us_states$region,tolower(all_states))]
View(us_states)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_states<- map_data("state")
us_states$subregion<- state.abb[match(us_states$region,tolower(all_states))]
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ subregion, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = subregion, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
abb<- state.abb[match(us_states$region,tolower(all_states))]
View(US_death)
View(death_count)
us_states$subregion<- lapply(us_states$region, state.abb, match(us_states$region,tolower(all_states))
us_states$subregion<- lapply(us_states$region, state.abb, match(us_states$region,tolower(all_states)))
# state.abb[match(us_states$region,tolower(all_states))]
us_fsmoking<- left_join(us_states, fsmoking.df)
us_states$subregion<- lapply(us_states$region, state.abb, match(us_states$region,tolower(all_states)))
f1<- function(x,y){
state.abb[match(x,y)]
}
us_states$subregion<- lapply(us_states$region, f1, y=tolower(all_states))
View(US_smoking)
View(us_states)
state.name
us_states$abbrev <- state.abb[us_states$region]
View(us_states)
us_states$abbrev <- state.abb[toupper(us_states$region)]
View(us_states)
toupper(us_states$region)[1]
install.packages("Hmisc")
library(Hmisc)
us_states$abbrev <- state.abb[capitalize(us_states$region)]
View(us_states)
capitalize(us_states$region)[1]
state.abb[capitalize(us_states$region)]
state.abb[capitalize(us_states$region),]
us_states$abbrev <- state.abb[match(capitalize(us_states$region), state.name)]
View(us_states)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_states<- map_data("state")
us_states$abbrev <- state.abb[match(capitalize(us_states$region), state.name)]
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ abbrev, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
state.abb[capitalize(us_states$region)]
capitalize("new york")
install.packages("tools")
library(tools)
library(tools)
us_states$abbrev <- state.abb[match(toTitleCase(us_states$region), state.name)]
View(us_states)
# US_smoking value is the median value of states and DC
US_smoking<- US_behavior %>% filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df<- behaviors_sex.df %>%
filter(grepl(paste("Smoking", collapse="|"), Measure.Name))
smoking.df$value.disparity<- log(smoking.df$Value/US_smoking$Value)
fsmoking.df<- smoking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= fdeath.df$death.disparity) %>%
mutate(dgroup= fdeath.df$dgroup)
fsmoking.df$region<- tolower(fsmoking.df$State.Name)
fsmoking.df$vgroup<- as.numeric(cut(fsmoking.df$value.disparity, breaks = vcut_by))
msmoking.df<- smoking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name)) %>%
mutate(death.disparity= mdeath.df$death.disparity) %>%
mutate(dgroup= mdeath.df$dgroup)
msmoking.df$region<- tolower(msmoking.df$State.Name)
msmoking.df$vgroup<- as.numeric(cut(msmoking.df$value.disparity, breaks = vcut_by))
us_states<- map_data("state")
us_states$abbrev <- state.abb[match(toTitleCase(us_states$region), state.name)]
us_fsmoking<- left_join(us_states, fsmoking.df)
us_msmoking<- left_join(us_states, msmoking.df)
cnames <- aggregate(cbind(long, lat) ~ abbrev, data=us_fsmoking,
FUN=function(x)mean(range(x)))
# Plot female and male smoking disparity
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) + coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
smoke_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
smoke_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Male Smoking Disparity")+labs(fill = "Smoking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
plot_grid(smoke_1, smoke_2, ncol = 1)
# Plot femake and male COVID 19 death disparity
dlabel<- c("-5 to -2", "-2 to -1", "-1 to -.2", "-.2 to .2", ".2 to 1", "1 to 2", "2 to 5", "NA")
covid_1<- ggplot(data = us_fsmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
covid_2<- ggplot(data = us_msmoking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(dgroup))) +
geom_polygon(color = "gray90", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Male COVID 19 Death Disparity")+labs(fill = "Death Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= dlabel, direction=-1)
plot_grid(covid_1, covid_2, ncol = 1)
# US_drinking value is the median value of states and DC
US_drinking<- US_behavior %>% filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
# Filter out information about excessive drinking
drinking.df<- behaviors_sex.df %>%
filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
drinking.df$value.disparity<- log(drinking.df$Value/US_drinking$Value)
# Separate excessive drinking data by geneder
fdrinking.df<- drinking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
fdrinking.df$region<- tolower(fdrinking.df$State.Name)
fdrinking.df$vgroup<- as.numeric(cut(fdrinking.df$value.disparity, breaks = vcut_by))
# Merge US map data and excessive drinking data for female and male
mdrinking.df<- drinking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
mdrinking.df$region<- tolower(mdrinking.df$State.Name)
mdrinking.df$vgroup<- as.numeric(cut(mdrinking.df$value.disparity, breaks = vcut_by))
# Merge US map data and excessive drinking data for female and male
us_fdrinking<- left_join(us_states, fdrinking.df)
us_mdrinking<- left_join(us_states, mdrinking.df)
# Plot femake and male excessive drinking disparity
drinking_1<- ggplot(data = us_fdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "white", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
drinking_2<- ggplot(data = us_mdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "white", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Male Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
# Combine the two maps
plot_grid(drinking_1, drinking_2, ncol = 1)
# US_drinking value is the median value of states and DC
US_drinking<- US_behavior %>% filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
# Filter out information about excessive drinking
drinking.df<- behaviors_sex.df %>%
filter(grepl(paste("Excessive Drinking", collapse="|"), Measure.Name))
drinking.df$value.disparity<- log(drinking.df$Value/US_drinking$Value)
# Separate excessive drinking data by geneder
fdrinking.df<- drinking.df %>%
filter(grepl(paste("Female", collapse="|"), Measure.Name))
fdrinking.df$region<- tolower(fdrinking.df$State.Name)
fdrinking.df$vgroup<- as.numeric(cut(fdrinking.df$value.disparity, breaks = vcut_by))
# Merge US map data and excessive drinking data for female and male
mdrinking.df<- drinking.df %>%
filter(grepl(paste("Male", collapse="|"), Measure.Name))
mdrinking.df$region<- tolower(mdrinking.df$State.Name)
mdrinking.df$vgroup<- as.numeric(cut(mdrinking.df$value.disparity, breaks = vcut_by))
# Merge US map data and excessive drinking data for female and male
us_fdrinking<- left_join(us_states, fdrinking.df)
us_mdrinking<- left_join(us_states, mdrinking.df)
# Plot femake and male excessive drinking disparity
drinking_1<- ggplot(data = us_fdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "white", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Female Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
drinking_2<- ggplot(data = us_mdrinking, mapping = aes(x = long, y = lat, group = group, fill = as.factor(vgroup))) +
geom_polygon(color = "white", size = 0.2) +
with(cnames, annotate(geom="text", x = long, y=lat, label = abbrev, size = 2.5))+ coord_quickmap() +
theme_map()+labs(title = "US Male Excessive Drinking Disparity")+labs(fill = "Excessive Drinking Disparity") +
scale_fill_brewer(palette = "RdYlBu", labels= vlabel, direction=-1)
# Combine the two maps
plot_grid(drinking_1, drinking_2, ncol = 1)
