#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
selected_state <- "TX"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
n_county <- length(unique(covid_TS_counties.cases.plot$County))
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))  %>%
filter(date == min_date | date == min_date+1 | date == min_date - 1) %>%
top_n(1)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
?top_n
selected_state <- "TX"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
n_county <- length(unique(covid_TS_counties.cases.plot$County))
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))  %>%
filter(date == min_date | date == min_date+1 | date == min_date - 1) %>%
top_n(1, wt=cases)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
View(highlight_points)
selected_state <- "TX"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
n_county <- length(unique(covid_TS_counties.cases.plot$County))
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))  %>%
filter(date == min_date | date == min_date+1 | date == min_date - 1) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
selected_state <- "TX"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
n_county <- length(unique(covid_TS_counties.cases.plot$County))
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))
covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))
selected_state <- "AK"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
n_county <- length(unique(covid_TS_counties.cases.plot$County))
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
mutate(spacing = row_number()) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))
highlight_points <- covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(spacing = row_number()) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(spacing = row_number()) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))
covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(spacing = n()) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((spacing*((range%/%n_county)))%%range))
covid_TS_counties.cases.plot  %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(spacing = row_number())
unique(covid_TS_counties.cases.plot$County) %>% n()
unique(covid_TS_counties.cases.plot$County) %>% row_number()
unique(covid_TS_counties.cases.plot$County) %>%
cbind.data.frame(row_number())
unique(covid_TS_counties.cases.plot$County) %>%
as.data.frame() %>%
mutate(num = row_number())
county.num <- unique(covid_TS_counties.cases.plot$County) %>%
as.data.frame() %>%
mutate(num = row_number())
View(county.num)
?as.data.frame
county.num <- unique(covid_TS_counties.cases.plot$County) %>% as.data.frame()
colnames(county.num) <- c("County")
county.num <- county.num %>%
mutate(num = row_number())
View(county.num)
covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County"))
covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))  %>%
filter(date == min_date)
covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))
highlight_points <- covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))
selected_state <- "AK"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
county.num <- unique(covid_TS_counties.cases.plot$County) %>% as.data.frame()
colnames(county.num) <- c("County")
county.num <- county.num %>%
mutate(num = row_number())
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
selected_state <- "NY"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
county.num <- unique(covid_TS_counties.cases.plot$County) %>% as.data.frame()
colnames(county.num) <- c("County")
county.num <- county.num %>%
mutate(num = row_number())
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
selected_state <- "TX"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
county.num <- unique(covid_TS_counties.cases.plot$County) %>% as.data.frame()
colnames(county.num) <- c("County")
county.num <- county.num %>%
mutate(num = row_number())
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
selected_state <- "GA"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
county.num <- unique(covid_TS_counties.cases.plot$County) %>% as.data.frame()
colnames(county.num) <- c("County")
county.num <- county.num %>%
mutate(num = row_number())
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
selected_state <- "GA"
covid_TS_counties.cases.plot <- covid_TS_counties_long.cases %>%
filter(State == selected_state)
county.num <- unique(covid_TS_counties.cases.plot$County) %>% as.data.frame()
colnames(county.num) <- c("County")
county.num <- county.num %>%
mutate(num = row_number())
n_case_cut <- 10
highlight_points <- covid_TS_counties.cases.plot  %>%
left_join(county.num, by=c("County" = "County")) %>%
filter(cases > n_case_cut*n_county) %>%
group_by(County) %>%
mutate(range = as.numeric(as.Date(max(date))) - as.numeric(as.Date(min(date)))) %>%
mutate(min_date = as.Date(min(date))) %>%
mutate(min_date = min_date + ((num*((range%/%n_county)))%%range))  %>%
filter(date == min_date) %>%
top_n(1, wt=min_date)
g <- covid_TS_counties.cases.plot %>%
filter(cases > n_case_cut*n_county) %>%
ggplot(aes(date,
cases,
color = County,
group = County)) +
geom_line(size=1) +
scale_y_continuous(
trans = "log10",
breaks = c(10,100,500,1000,5000,10000, 50000)
) +
scale_x_datetime(date_breaks = "1 week", date_minor_breaks = "1 day", date_labels = "%b %d") +
ylab("Cases") +
xlab("Date") +
theme(legend.position = "none") +
geom_label_repel(
data=highlight_points,
aes(label=County,fill=County),
box.padding = unit(1.75, 'lines'),
color = "black",
segment.color = "black",
size = 5,
show.legend = FALSE
) +
ggtitle(paste0(selected_state, " cases over time"))  +
# geom_vline(aes(xintercept=as_datetime("2020-03-20"), linetype="Gov. Cuomo issues stay-at-home order"), color = "black") +
#scale_linetype_manual(name = "Events",
#                      values = c(2,2),
#                      guide = guide_legend(override.aes = list(color = c("blue","black")))) +
NULL
g
